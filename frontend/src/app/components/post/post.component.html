<div class="container my-4">
  <div class="mb-4">
    <h4 class="mb-3">Create a New Post</h4>
    <div class="input-group mb-2">
      <span class="input-group-text">Title</span>
      <input
        type="text"
        class="form-control"
        [(ngModel)]="newPost.title"
        placeholder="Enter title"
      />
    </div>
    <div class="input-group mb-3">
      <span class="input-group-text">Body</span>
      <input
        type="text"
        class="form-control"
        [(ngModel)]="newPost.body"
        placeholder="Enter body"
      />
    </div>
    <button class="btn btn-primary" (click)="addPost()">Add Post</button>
  </div>

  <div *ngFor="let post of posts" class="card mb-4 shadow-sm">
    <div class="card-body">
      <h5 class="card-title text-capitalize">{{ post.title }}</h5>
      <p class="card-text">{{ post.body }}</p>

      <div class="d-flex justify-content-between text-muted mb-2">
        <small><strong>By:</strong> {{ post.user.name }}</small>
        <small
          ><strong>Posted on:</strong>
          {{ post.createdAt | date : "medium" }}</small
        >
      </div>

      <div class="d-flex gap-3 align-items-center mb-3">
        <button
          class="btn btn-outline-success btn-sm"
          (click)="likePost(post.id)"
        >
          <i class="bi bi-hand-thumbs-up-fill me-1"></i>
          <span [style.color]="post.liked ? 'green' : 'black'"></span>
          {{ post.likes }}
        </button>

        <button
          class="btn btn-outline-danger btn-sm"
          (click)="dislikePost(post.id)"
        >
          <i class="bi bi-hand-thumbs-down-fill me-1"></i>
          <span [style.color]="post.disliked ? 'red' : 'black'">
            {{ post.dislikes }}</span
          >
        </button>
      </div>

      <button
        class="btn btn-secondary btn-sm mb-2"
        (click)="toggleComments(post.id)"
      >
        {{ post.id === selectedPostId ? "Hide" : "Show" }} Comments
      </button>

      <div *ngIf="post.id === selectedPostId">
        <h6 class="text-secondary mt-3">Comments:</h6>
        <div *ngIf="post.comments.length === 0" class="text-muted mb-2">
          No Comments Yet
        </div>

        <ul
          class="list-group list-group-flush mb-3"
          *ngIf="post.comments.length > 0"
        >
          <li *ngFor="let comment of post.comments" class="list-group-item">
            <p class="mb-1">{{ comment.body }}</p>
            <div class="d-flex justify-content-between text-muted">
              <small>â€” {{ comment.user.name }}</small>
              <small>{{ comment.createdAt | date : "short" }}</small>
            </div>
          </li>
        </ul>

        <div class="input-group mb-2">
          <input
            type="text"
            class="form-control"
            placeholder="Write a comment..."
            [(ngModel)]="commentBody"
          />
          <button class="btn btn-outline-primary" (click)="addComment(post.id)">
            Add
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
